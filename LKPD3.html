<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LKPD Interaktif - Sistem Persamaan Linear Dua Variabel (Metode Substitusi & Eliminasi)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .section-card { transition: all 0.3s ease; }
        .section-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .correct { background-color: #d4edda; border-color: #c3e6cb; color: #155724; }
        .incorrect { background-color: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .step-highlight { background-color: #fff3cd; border-left: 4px solid #ffc107; }
        .method-card { border: 2px solid transparent; transition: all 0.3s ease; cursor: pointer; }
        .method-card:hover { border-color: #3b82f6; transform: scale(1.02); }
        .method-card.active { border-color: #10b981; background-color: #f0fdf4; }
        .step-container { min-height: 400px; }
        .equation-input { font-family: 'Courier New', monospace; }
        .solution-step { margin: 10px 0; padding: 10px; border-radius: 8px; }
        .step-number { background: #3b82f6; color: white; border-radius: 50%; width: 24px; height: 24px; display: inline-flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; }
        @media print {
            .no-print { display: none !important; }
            .section-card { break-inside: avoid; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 shadow-lg">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-3xl font-bold text-center mb-2">📚 LKPD Interaktif Matematika</h1>
            <h2 class="text-xl text-center mb-4">Sistem Persamaan Linear Dua Variabel</h2>
            <div class="bg-white/20 rounded-lg p-4 text-center">
                <p class="font-semibold">🎯 Tujuan Pembelajaran:</p>
                <p class="text-sm mt-1">Memahami konsep sistem persamaan linear dua variabel dan menyelesaikan persamaan linear dua variabel dengan metode substitusi dan eliminasi</p>
            </div>
        </div>
    </header>

    <div class="max-w-6xl mx-auto p-6 space-y-8">
        <!-- Control Buttons -->
        <div class="flex justify-center space-x-4 no-print">
            <button onclick="resetAll()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                🔄 Reset Semua
            </button>
            <button onclick="window.print()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                🖨️ Cetak LKPD
            </button>
        </div>

        <!-- Section 1: Review -->
        <section class="section-card bg-gradient-to-r from-orange-100 to-red-100 rounded-xl p-6 shadow-lg">
            <h3 class="text-2xl font-bold text-orange-800 mb-4">🔍 Bagian Review - Materi Prasyarat</h3>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg p-4">
                    <h4 class="font-semibold text-orange-700 mb-2">📈 Sistem Persamaan Linear</h4>
                    <p class="text-gray-700 mb-2">Bentuk umum: $\begin{cases} a_1x + b_1y = c_1 \\ a_2x + b_2y = c_2 \end{cases}$</p>
                    <p class="text-sm text-gray-600">Contoh: $\begin{cases} 2x + 3y = 12 \\ x - y = 1 \end{cases}$</p>
                    <p class="text-sm text-gray-600">Solusi: nilai x dan y yang memenuhi kedua persamaan</p>
                </div>
                <div class="bg-white rounded-lg p-4">
                    <h4 class="font-semibold text-orange-700 mb-2">🔧 Operasi Aljabar</h4>
                    <p class="text-gray-700 text-sm">• Penjumlahan dan pengurangan persamaan</p>
                    <p class="text-gray-700 text-sm">• Perkalian persamaan dengan konstanta</p>
                    <p class="text-gray-700 text-sm">• Substitusi variabel</p>
                    <p class="text-gray-700 text-sm">• Isolasi variabel</p>
                </div>
            </div>
        </section>

        <!-- Section 2: Soal Pematik -->
        <section class="section-card bg-gradient-to-r from-green-100 to-teal-100 rounded-xl p-6 shadow-lg">
            <h3 class="text-2xl font-bold text-green-800 mb-4">💡 Soal Pematik - Membangun Pemahaman</h3>
            <div class="space-y-4">
                <div class="bg-white rounded-lg p-4">
                    <h4 class="font-semibold text-green-700 mb-2">🏪 Situasi: Toko Buku Pak Ahmad</h4>
                    <p class="text-gray-700 mb-2">Pak Ahmad menjual buku tulis dan pensil. Hari ini ada dua transaksi:</p>
                    <p class="text-gray-700 mb-1">• Transaksi 1: 3 buku + 2 pensil = Rp 11.000</p>
                    <p class="text-gray-700 mb-3">• Transaksi 2: 2 buku + 4 pensil = Rp 14.000</p>
                    <div class="bg-green-50 p-3 rounded-lg">
                        <p class="text-sm text-green-600 font-medium">🤔 Pertanyaan Pemicu:</p>
                        <p class="text-sm text-gray-700">1. Bagaimana cara menentukan harga 1 buku dan 1 pensil?</p>
                        <p class="text-sm text-gray-700">2. Apakah ada cara selain menggambar grafik?</p>
                        <p class="text-sm text-gray-700">3. Metode mana yang lebih praktis untuk perhitungan?</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Materi Inti -->
        <section class="section-card bg-gradient-to-r from-blue-100 to-indigo-100 rounded-xl p-6 shadow-lg">
            <h3 class="text-2xl font-bold text-blue-800 mb-4">📖 Materi Inti - Metode Penyelesaian</h3>
            
            <!-- Method Selection -->
            <div class="grid md:grid-cols-2 gap-6 mb-6">
                <div class="method-card bg-white rounded-lg p-4" onclick="selectMethod('substitusi')">
                    <h4 class="font-semibold text-blue-700 mb-3">🔄 Metode Substitusi</h4>
                    <div class="text-sm text-gray-600 space-y-2">
                        <p><strong>Prinsip:</strong> Mengganti satu variabel dengan ekspresi dari persamaan lain</p>
                        <p><strong>Langkah:</strong></p>
                        <p>1. Isolasi salah satu variabel dari persamaan pertama</p>
                        <p>2. Substitusi ke persamaan kedua</p>
                        <p>3. Selesaikan persamaan satu variabel</p>
                        <p>4. Cari nilai variabel lainnya</p>
                    </div>
                </div>
                
                <div class="method-card bg-white rounded-lg p-4" onclick="selectMethod('eliminasi')">
                    <h4 class="font-semibold text-blue-700 mb-3">➖ Metode Eliminasi</h4>
                    <div class="text-sm text-gray-600 space-y-2">
                        <p><strong>Prinsip:</strong> Menghilangkan salah satu variabel dengan operasi aljabar</p>
                        <p><strong>Langkah:</strong></p>
                        <p>1. Samakan koefisien salah satu variabel</p>
                        <p>2. Kurangkan atau jumlahkan kedua persamaan</p>
                        <p>3. Selesaikan persamaan satu variabel</p>
                        <p>4. Substitusi untuk mencari variabel lainnya</p>
                    </div>
                </div>
            </div>

            <!-- Interactive Method Demonstration -->
            <div id="method-demo" class="bg-white rounded-lg p-6">
                <h4 class="font-semibold text-blue-700 mb-4">📋 Demonstrasi Interaktif</h4>
                <p class="text-gray-600 mb-4">Pilih salah satu metode di atas untuk melihat demonstrasi langkah demi langkah</p>
                
                <!-- Substitution Demo -->
                <div id="substitusi-demo" class="hidden">
                    <h5 class="font-semibold text-blue-600 mb-3">Contoh: Metode Substitusi</h5>
                    <div class="bg-blue-50 p-4 rounded-lg mb-4">
                        <p class="text-center font-medium">Sistem: $\begin{cases} 2x + y = 7 \\ x - y = 2 \end{cases}$</p>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="solution-step bg-yellow-50 border-l-4 border-yellow-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">1</span>
                                <span class="ml-2 font-semibold">Pilih persamaan yang mudah diisolasi</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p class="text-sm text-gray-600">Persamaan (1): $2x + y = 7$ → untuk isolasi y: $y = 7 - 2x$</p>
                                <p class="text-sm text-gray-600">Persamaan (2): $x - y = 2$ → untuk isolasi x: $x = y + 2$ ✓ (lebih mudah)</p>
                                <p class="font-medium text-blue-700">Pilih persamaan (2) karena koefisien x = 1</p>
                            </div>
                        </div>
                        
                        <div class="solution-step bg-yellow-50 border-l-4 border-yellow-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">2</span>
                                <span class="ml-2 font-semibold">Isolasi variabel x dari persamaan kedua</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p>Persamaan (2): $x - y = 2$</p>
                                <p>Pindahkan $-y$ ke ruas kanan: $x = 2 + y$</p>
                                <p class="font-medium text-blue-700">Hasil: $x = y + 2$</p>
                            </div>
                        </div>
                        
                        <div class="solution-step bg-yellow-50 border-l-4 border-yellow-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">3</span>
                                <span class="ml-2 font-semibold">Substitusi $x = y + 2$ ke persamaan pertama</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p>Persamaan (1): $2x + y = 7$</p>
                                <p>Ganti x dengan $(y + 2)$: $2(y + 2) + y = 7$</p>
                                <p>Distribusikan: $2y + 4 + y = 7$</p>
                                <p>Gabungkan suku sejenis: $3y + 4 = 7$</p>
                                <p>Kurangi 4 dari kedua ruas: $3y = 7 - 4$</p>
                                <p>Sederhanakan: $3y = 3$</p>
                                <p class="font-medium text-blue-700">Bagi dengan 3: $y = 1$</p>
                            </div>
                        </div>
                        
                        <div class="solution-step bg-yellow-50 border-l-4 border-yellow-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">4</span>
                                <span class="ml-2 font-semibold">Cari nilai x dengan substitusi balik</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p>Gunakan $x = y + 2$ dan $y = 1$</p>
                                <p>$x = 1 + 2$</p>
                                <p class="font-medium text-blue-700">$x = 3$</p>
                            </div>
                        </div>
                        
                        <div class="solution-step bg-green-50 border-l-4 border-green-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">5</span>
                                <span class="ml-2 font-semibold">Verifikasi solusi: $(3, 1)$</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p>Cek persamaan (1): $2x + y = 2(3) + 1 = 6 + 1 = 7$ ✓</p>
                                <p>Cek persamaan (2): $x - y = 3 - 1 = 2$ ✓</p>
                                <p class="font-medium text-green-700">Solusi benar: $x = 3, y = 1$</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Elimination Demo -->
                <div id="eliminasi-demo" class="hidden">
                    <h5 class="font-semibold text-blue-600 mb-3">Contoh: Metode Eliminasi</h5>
                    <div class="bg-blue-50 p-4 rounded-lg mb-4">
                        <p class="text-center font-medium">Sistem: $\begin{cases} 3x + 2y = 16 \\ x + y = 6 \end{cases}$</p>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="solution-step bg-yellow-50 border-l-4 border-yellow-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">1</span>
                                <span class="ml-2 font-semibold">Tentukan variabel yang akan dieliminasi</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p class="text-sm text-gray-600">Persamaan (1): $3x + 2y = 16$ → koefisien x = 3, y = 2</p>
                                <p class="text-sm text-gray-600">Persamaan (2): $x + y = 6$ → koefisien x = 1, y = 1</p>
                                <p class="font-medium text-blue-700">Pilih eliminasi y karena koefisiennya lebih kecil (2 dan 1)</p>
                            </div>
                        </div>
                        
                        <div class="solution-step bg-yellow-50 border-l-4 border-yellow-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">2</span>
                                <span class="ml-2 font-semibold">Samakan koefisien variabel y</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p>Koefisien y: persamaan (1) = 2, persamaan (2) = 1</p>
                                <p>KPK dari 2 dan 1 adalah 2</p>
                                <p>Persamaan (1): $3x + 2y = 16$ → kalikan 1 → $3x + 2y = 16$</p>
                                <p>Persamaan (2): $x + y = 6$ → kalikan 2 → $2x + 2y = 12$</p>
                                <p class="font-medium text-blue-700">Sistem baru: $\begin{cases} 3x + 2y = 16 \\ 2x + 2y = 12 \end{cases}$</p>
                            </div>
                        </div>
                        
                        <div class="solution-step bg-yellow-50 border-l-4 border-yellow-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">3</span>
                                <span class="ml-2 font-semibold">Eliminasi variabel y dengan pengurangan</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p>Karena koefisien y sama (2y dan 2y), gunakan pengurangan:</p>
                                <p>$(3x + 2y) - (2x + 2y) = 16 - 12$</p>
                                <p>$3x + 2y - 2x - 2y = 4$</p>
                                <p>$(3x - 2x) + (2y - 2y) = 4$</p>
                                <p>$x + 0 = 4$</p>
                                <p class="font-medium text-blue-700">$x = 4$</p>
                            </div>
                        </div>
                        
                        <div class="solution-step bg-yellow-50 border-l-4 border-yellow-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">4</span>
                                <span class="ml-2 font-semibold">Substitusi untuk mencari nilai y</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p>Gunakan persamaan (2): $x + y = 6$ dan $x = 4$</p>
                                <p>$4 + y = 6$</p>
                                <p>$y = 6 - 4$</p>
                                <p class="font-medium text-blue-700">$y = 2$</p>
                            </div>
                        </div>
                        
                        <div class="solution-step bg-green-50 border-l-4 border-green-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">5</span>
                                <span class="ml-2 font-semibold">Verifikasi solusi: $(4, 2)$</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p>Cek persamaan (1): $3x + 2y = 3(4) + 2(2) = 12 + 4 = 16$ ✓</p>
                                <p>Cek persamaan (2): $x + y = 4 + 2 = 6$ ✓</p>
                                <p class="font-medium text-green-700">Solusi benar: $x = 4, y = 2$</p>
                            </div>
                        </div>
                        
                        <div class="solution-step bg-blue-50 border-l-4 border-blue-400">
                            <div class="flex items-center mb-2">
                                <span class="step-number">💡</span>
                                <span class="ml-2 font-semibold">Alternatif: Eliminasi variabel x</span>
                            </div>
                            <div class="ml-8 space-y-2">
                                <p class="text-sm">Untuk eliminasi x, kalikan persamaan (2) dengan 3:</p>
                                <p class="text-sm">$\begin{cases} 3x + 2y = 16 \\ 3x + 3y = 18 \end{cases}$</p>
                                <p class="text-sm">$(3x + 3y) - (3x + 2y) = 18 - 16$ → $y = 2$</p>
                                <p class="text-sm text-gray-600">Hasilnya sama, pilih cara yang lebih mudah!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Latihan Mengubah Cerita ke Sistem Persamaan -->
        <section class="section-card bg-gradient-to-r from-teal-100 to-cyan-100 rounded-xl p-6 shadow-lg">
            <h3 class="text-2xl font-bold text-teal-800 mb-4">📚 Latihan Mengubah Cerita ke Sistem Persamaan</h3>
            
            <div class="bg-white rounded-lg p-4 mb-6">
                <h4 class="font-semibold text-teal-700 mb-3">🎭 Simulator Cerita Matematika</h4>
                <p class="text-gray-700 mb-4">Ubah cerita berikut menjadi sistem persamaan linear dua variabel:</p>
                
                <!-- Story Problem Generator -->
                <div class="bg-teal-50 p-4 rounded-lg mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <h5 class="font-semibold text-teal-700">Cerita Matematika:</h5>
                        <button onclick="generateNewStoryProblem()" class="bg-teal-500 text-white px-3 py-1 rounded text-sm hover:bg-teal-600">🎲 Cerita Baru</button>
                    </div>
                    <div id="current-story-problem" class="bg-white p-4 rounded-lg border">
                        <div id="story-text" class="text-gray-700 mb-3">
                            <p>Di sebuah toko, Ani membeli 3 buku dan 2 pensil dengan harga total Rp 15.000. Budi membeli 2 buku dan 4 pensil dengan harga total Rp 18.000. Tentukan harga 1 buku dan 1 pensil!</p>
                        </div>
                        <p class="text-sm text-gray-600">Cerita 1 dari 20</p>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- Input Area -->
                    <div>
                        <h5 class="font-semibold text-teal-600 mb-2">✏️ Tulis Sistem Persamaan:</h5>
                        <div class="space-y-3">
                            <div class="bg-teal-50 p-3 rounded-lg">
                                <label class="block text-sm font-medium mb-2">Definisikan Variabel:</label>
                                <div class="space-y-2">
                                    <input id="var-x-def" type="text" class="w-full p-2 border rounded text-sm" placeholder="x = ...">
                                    <input id="var-y-def" type="text" class="w-full p-2 border rounded text-sm" placeholder="y = ...">
                                </div>
                            </div>
                            
                            <div class="bg-teal-50 p-3 rounded-lg">
                                <label class="block text-sm font-medium mb-2">Persamaan 1:</label>
                                <input id="equation-1" type="text" class="w-full p-2 border rounded equation-input" placeholder="Contoh: 3x + 2y = 15000">
                            </div>
                            
                            <div class="bg-teal-50 p-3 rounded-lg">
                                <label class="block text-sm font-medium mb-2">Persamaan 2:</label>
                                <input id="equation-2" type="text" class="w-full p-2 border rounded equation-input" placeholder="Contoh: 2x + 4y = 18000">
                            </div>
                            
                            <button onclick="checkStoryEquations()" class="w-full bg-teal-500 text-white px-3 py-2 rounded hover:bg-teal-600">Periksa Sistem Persamaan</button>
                            <div id="story-equation-feedback" class="mt-2"></div>
                        </div>
                    </div>
                    
                    <!-- Solution Area -->
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h5 class="font-semibold text-teal-600 mb-2">🧮 Selesaikan Sistem:</h5>
                        
                        <div class="space-y-3">
                            <div class="bg-white p-3 rounded-lg border">
                                <label class="block text-sm font-medium mb-2">Pilih Metode:</label>
                                <div class="flex space-x-2">
                                    <button id="story-method-substitusi" onclick="setStoryMethod('substitusi')" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">Substitusi</button>
                                    <button id="story-method-eliminasi" onclick="setStoryMethod('eliminasi')" class="bg-gray-300 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-400">Eliminasi</button>
                                </div>
                            </div>
                            
                            <div class="bg-white p-3 rounded-lg border">
                                <label class="block text-sm font-medium mb-2">Jawaban Akhir:</label>
                                <div class="space-y-2">
                                    <input id="story-answer-x" type="text" class="w-full p-2 border rounded text-sm" placeholder="Nilai x">
                                    <input id="story-answer-y" type="text" class="w-full p-2 border rounded text-sm" placeholder="Nilai y">
                                </div>
                            </div>
                            
                            <button onclick="checkStoryAnswer()" class="w-full bg-green-500 text-white px-3 py-2 rounded hover:bg-green-600">Periksa Jawaban</button>
                            <div id="story-answer-feedback" class="mt-2"></div>
                        </div>
                        
                        <!-- Progress -->
                        <div class="mt-4 bg-white p-3 rounded-lg border">
                            <h6 class="font-medium text-teal-700 mb-2">Progress:</h6>
                            <div class="text-xs text-gray-600">
                                <div class="flex justify-between">
                                    <span>Cerita Diselesaikan:</span>
                                    <span id="story-problems-solved">0/20</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                    <div id="story-progress-bar" class="bg-teal-500 h-2 rounded-full" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: Latihan Soal dengan Virtual Keyboard -->
        <section class="section-card bg-gradient-to-r from-indigo-100 to-blue-100 rounded-xl p-6 shadow-lg">
            <h3 class="text-2xl font-bold text-indigo-800 mb-4">⌨️ Latihan Soal dengan Virtual Keyboard</h3>
            
            <div class="bg-white rounded-lg p-4 mb-6">
                <h4 class="font-semibold text-indigo-700 mb-3">🧮 Generator Soal Sistem Persamaan</h4>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- Problem Area -->
                    <div>
                        <div class="bg-indigo-50 p-4 rounded-lg mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <h5 class="font-semibold text-indigo-700">Soal:</h5>
                                <button onclick="generateMathProblem()" class="bg-indigo-500 text-white px-3 py-1 rounded text-sm hover:bg-indigo-600">🎲 Soal Baru</button>
                            </div>
                            <div id="math-problem-display" class="text-center bg-white p-4 rounded border">
                                <p class="font-medium">$$\begin{cases} 2x + 3y = 13 \\ x - y = 1 \end{cases}$$</p>
                                <p class="text-sm text-gray-600 mt-2">Selesaikan sistem persamaan di atas!</p>
                            </div>
                        </div>
                        
                        <!-- Method Selection -->
                        <div class="bg-indigo-50 p-3 rounded-lg mb-4">
                            <label class="block text-sm font-medium mb-2">Pilih Metode:</label>
                            <div class="flex space-x-2">
                                <button id="math-method-substitusi" onclick="setMathMethod('substitusi')" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">Substitusi</button>
                                <button id="math-method-eliminasi" onclick="setMathMethod('eliminasi')" class="bg-gray-300 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-400">Eliminasi</button>
                            </div>
                        </div>
                        
                        <!-- Solution Input -->
                        <div class="bg-indigo-50 p-3 rounded-lg">
                            <label class="block text-sm font-medium mb-2">Tulis Langkah Penyelesaian:</label>
                            <textarea id="solution-steps" class="w-full h-32 p-2 border rounded text-sm font-mono" placeholder="Tulis langkah-langkah penyelesaian di sini...&#10;Gunakan keyboard virtual di bawah untuk simbol matematika"></textarea>
                            
                            <div class="mt-3 grid grid-cols-2 gap-2">
                                <div>
                                    <label class="block text-xs font-medium mb-1">Nilai x:</label>
                                    <input id="math-answer-x" type="text" class="w-full p-2 border rounded text-sm" placeholder="x = ...">
                                </div>
                                <div>
                                    <label class="block text-xs font-medium mb-1">Nilai y:</label>
                                    <input id="math-answer-y" type="text" class="w-full p-2 border rounded text-sm" placeholder="y = ...">
                                </div>
                            </div>
                            
                            <button onclick="checkMathSolution()" class="w-full mt-3 bg-indigo-500 text-white px-3 py-2 rounded hover:bg-indigo-600">Periksa Jawaban</button>
                            <div id="math-solution-feedback" class="mt-2"></div>
                        </div>
                    </div>
                    
                    <!-- Virtual Keyboard -->
                    <div>
                        <h5 class="font-semibold text-indigo-600 mb-2">🎹 Virtual Keyboard Matematika</h5>
                        <div class="bg-gray-100 p-4 rounded-lg">
                            <!-- Numbers -->
                            <div class="mb-3">
                                <p class="text-xs font-medium mb-2">Angka:</p>
                                <div class="grid grid-cols-5 gap-1">
                                    <button onclick="insertSymbol('1')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">1</button>
                                    <button onclick="insertSymbol('2')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">2</button>
                                    <button onclick="insertSymbol('3')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">3</button>
                                    <button onclick="insertSymbol('4')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">4</button>
                                    <button onclick="insertSymbol('5')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">5</button>
                                    <button onclick="insertSymbol('6')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">6</button>
                                    <button onclick="insertSymbol('7')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">7</button>
                                    <button onclick="insertSymbol('8')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">8</button>
                                    <button onclick="insertSymbol('9')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">9</button>
                                    <button onclick="insertSymbol('0')" class="bg-white border p-2 rounded text-sm hover:bg-gray-50">0</button>
                                </div>
                            </div>
                            
                            <!-- Variables -->
                            <div class="mb-3">
                                <p class="text-xs font-medium mb-2">Variabel:</p>
                                <div class="grid grid-cols-4 gap-1">
                                    <button onclick="insertSymbol('x')" class="bg-blue-100 border p-2 rounded text-sm hover:bg-blue-200">x</button>
                                    <button onclick="insertSymbol('y')" class="bg-blue-100 border p-2 rounded text-sm hover:bg-blue-200">y</button>
                                    <button onclick="insertSymbol('z')" class="bg-blue-100 border p-2 rounded text-sm hover:bg-blue-200">z</button>
                                    <button onclick="insertSymbol('a')" class="bg-blue-100 border p-2 rounded text-sm hover:bg-blue-200">a</button>
                                </div>
                            </div>
                            
                            <!-- Operations -->
                            <div class="mb-3">
                                <p class="text-xs font-medium mb-2">Operasi:</p>
                                <div class="grid grid-cols-4 gap-1">
                                    <button onclick="insertSymbol(' + ')" class="bg-green-100 border p-2 rounded text-sm hover:bg-green-200">+</button>
                                    <button onclick="insertSymbol(' - ')" class="bg-green-100 border p-2 rounded text-sm hover:bg-green-200">-</button>
                                    <button onclick="insertSymbol(' × ')" class="bg-green-100 border p-2 rounded text-sm hover:bg-green-200">×</button>
                                    <button onclick="insertSymbol(' ÷ ')" class="bg-green-100 border p-2 rounded text-sm hover:bg-green-200">÷</button>
                                </div>
                            </div>
                            
                            <!-- Symbols -->
                            <div class="mb-3">
                                <p class="text-xs font-medium mb-2">Simbol:</p>
                                <div class="grid grid-cols-4 gap-1">
                                    <button onclick="insertSymbol(' = ')" class="bg-yellow-100 border p-2 rounded text-sm hover:bg-yellow-200">=</button>
                                    <button onclick="insertSymbol('(')" class="bg-yellow-100 border p-2 rounded text-sm hover:bg-yellow-200">(</button>
                                    <button onclick="insertSymbol(')')" class="bg-yellow-100 border p-2 rounded text-sm hover:bg-yellow-200">)</button>
                                    <button onclick="insertSymbol('/')" class="bg-yellow-100 border p-2 rounded text-sm hover:bg-yellow-200">/</button>
                                </div>
                            </div>
                            
                            <!-- Superscript -->
                            <div class="mb-3">
                                <p class="text-xs font-medium mb-2">Pangkat:</p>
                                <div class="grid grid-cols-5 gap-1">
                                    <button onclick="insertSuperscript('²')" class="bg-purple-100 border p-2 rounded text-sm hover:bg-purple-200">x²</button>
                                    <button onclick="insertSuperscript('³')" class="bg-purple-100 border p-2 rounded text-sm hover:bg-purple-200">x³</button>
                                    <button onclick="insertSuperscript('⁴')" class="bg-purple-100 border p-2 rounded text-sm hover:bg-purple-200">x⁴</button>
                                    <button onclick="insertSuperscript('⁵')" class="bg-purple-100 border p-2 rounded text-sm hover:bg-purple-200">x⁵</button>
                                    <button onclick="insertSuperscript('ⁿ')" class="bg-purple-100 border p-2 rounded text-sm hover:bg-purple-200">xⁿ</button>
                                </div>
                            </div>
                            
                            <!-- Controls -->
                            <div class="grid grid-cols-3 gap-1">
                                <button onclick="insertNewLine()" class="bg-gray-200 border p-2 rounded text-xs hover:bg-gray-300">Enter</button>
                                <button onclick="insertSpace()" class="bg-gray-200 border p-2 rounded text-xs hover:bg-gray-300">Space</button>
                                <button onclick="deleteLastChar()" class="bg-red-200 border p-2 rounded text-xs hover:bg-red-300">⌫</button>
                            </div>
                        </div>
                        
                        <!-- Progress -->
                        <div class="mt-4 bg-white p-3 rounded-lg border">
                            <h6 class="font-medium text-indigo-700 mb-2">Progress Latihan:</h6>
                            <div class="text-xs text-gray-600">
                                <div class="flex justify-between">
                                    <span>Soal Diselesaikan:</span>
                                    <span id="math-problems-solved">0/∞</span>
                                </div>
                                <div class="flex justify-between mt-1">
                                    <span>Tingkat Kesulitan:</span>
                                    <select id="difficulty-level" onchange="updateDifficulty()" class="text-xs border rounded px-1">
                                        <option value="easy">Mudah</option>
                                        <option value="medium">Sedang</option>
                                        <option value="hard">Sulit</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: Latihan Soal -->
        <section class="section-card bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-6 shadow-lg">
            <h3 class="text-2xl font-bold text-purple-800 mb-4">📝 Latihan Soal Interaktif</h3>
            <div class="mb-4 text-center">
                <div class="inline-flex space-x-4 bg-white rounded-lg p-2">
                    <span class="bg-green-200 text-green-800 px-3 py-1 rounded text-sm">Mudah: 4 soal</span>
                    <span class="bg-yellow-200 text-yellow-800 px-3 py-1 rounded text-sm">Sedang: 4 soal</span>
                    <span class="bg-red-200 text-red-800 px-3 py-1 rounded text-sm">Sulit: 2 soal</span>
                </div>
            </div>

            <div id="quiz-container" class="space-y-4">
                <!-- Soal Mudah -->
                <div class="quiz-question bg-green-50 border-l-4 border-green-500 p-4 rounded-lg" data-level="mudah">
                    <h4 class="font-semibold text-green-700 mb-2">🟢 Soal 1 (Mudah) - Konsep Substitusi</h4>
                    <p class="mb-3">Dari sistem $\begin{cases} x + y = 7 \\ x = 2y + 1 \end{cases}$, nilai y adalah...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q1" value="a" class="mr-2"> a) 1</label>
                        <label class="flex items-center"><input type="radio" name="q1" value="b" class="mr-2"> b) 2</label>
                        <label class="flex items-center"><input type="radio" name="q1" value="c" class="mr-2"> c) 3</label>
                        <label class="flex items-center"><input type="radio" name="q1" value="d" class="mr-2"> d) 4</label>
                    </div>
                    <button onclick="checkAnswer('q1', 'b', 'Benar! Substitusi x = 2y + 1 ke x + y = 7: (2y + 1) + y = 7 → 3y = 6 → y = 2.')" class="mt-3 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Cek Jawaban</button>
                    <div id="feedback-q1" class="mt-2"></div>
                </div>

                <div class="quiz-question bg-green-50 border-l-4 border-green-500 p-4 rounded-lg" data-level="mudah">
                    <h4 class="font-semibold text-green-700 mb-2">🟢 Soal 2 (Mudah) - Konsep Eliminasi</h4>
                    <p class="mb-3">Untuk mengeliminasi variabel x dari sistem $\begin{cases} 2x + 3y = 14 \\ 3x - y = 8 \end{cases}$, persamaan pertama harus dikalikan dengan...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q2" value="a" class="mr-2"> a) 2</label>
                        <label class="flex items-center"><input type="radio" name="q2" value="b" class="mr-2"> b) 3</label>
                        <label class="flex items-center"><input type="radio" name="q2" value="c" class="mr-2"> c) -2</label>
                        <label class="flex items-center"><input type="radio" name="q2" value="d" class="mr-2"> d) -3</label>
                    </div>
                    <button onclick="checkAnswer('q2', 'b', 'Benar! Untuk mengeliminasi x, koefisien x harus sama. Persamaan pertama: 2x, persamaan kedua: 3x. Kalikan persamaan pertama dengan 3 dan persamaan kedua dengan 2.')" class="mt-3 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Cek Jawaban</button>
                    <div id="feedback-q2" class="mt-2"></div>
                </div>

                <div class="quiz-question bg-green-50 border-l-4 border-green-500 p-4 rounded-lg" data-level="mudah">
                    <h4 class="font-semibold text-green-700 mb-2">🟢 Soal 3 (Mudah) - Penyelesaian Sederhana</h4>
                    <p class="mb-3">Solusi dari sistem $\begin{cases} x + y = 8 \\ x - y = 2 \end{cases}$ adalah...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q3" value="a" class="mr-2"> a) (5, 3)</label>
                        <label class="flex items-center"><input type="radio" name="q3" value="b" class="mr-2"> b) (4, 4)</label>
                        <label class="flex items-center"><input type="radio" name="q3" value="c" class="mr-2"> c) (6, 2)</label>
                        <label class="flex items-center"><input type="radio" name="q3" value="d" class="mr-2"> d) (3, 5)</label>
                    </div>
                    <button onclick="checkAnswer('q3', 'a', 'Benar! Dengan eliminasi: (x + y) + (x - y) = 8 + 2 → 2x = 10 → x = 5. Substitusi: 5 + y = 8 → y = 3. Solusi: (5, 3).')" class="mt-3 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Cek Jawaban</button>
                    <div id="feedback-q3" class="mt-2"></div>
                </div>

                <div class="quiz-question bg-green-50 border-l-4 border-green-500 p-4 rounded-lg" data-level="mudah">
                    <h4 class="font-semibold text-green-700 mb-2">🟢 Soal 4 (Mudah) - Aplikasi Dasar</h4>
                    <p class="mb-3">Jumlah dua bilangan adalah 12, selisihnya adalah 4. Bilangan yang lebih besar adalah...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q4" value="a" class="mr-2"> a) 6</label>
                        <label class="flex items-center"><input type="radio" name="q4" value="b" class="mr-2"> b) 7</label>
                        <label class="flex items-center"><input type="radio" name="q4" value="c" class="mr-2"> c) 8</label>
                        <label class="flex items-center"><input type="radio" name="q4" value="d" class="mr-2"> d) 9</label>
                    </div>
                    <button onclick="checkAnswer('q4', 'c', 'Benar! Sistem: x + y = 12 dan x - y = 4. Eliminasi: 2x = 16 → x = 8. Bilangan yang lebih besar adalah 8.')" class="mt-3 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Cek Jawaban</button>
                    <div id="feedback-q4" class="mt-2"></div>
                </div>

                <!-- Soal Sedang -->
                <div class="quiz-question bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-lg" data-level="sedang">
                    <h4 class="font-semibold text-yellow-700 mb-2">🟡 Soal 5 (Sedang) - Substitusi Kompleks</h4>
                    <p class="mb-3">Solusi dari sistem $\begin{cases} 2x + 3y = 16 \\ x = y + 2 \end{cases}$ adalah...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q5" value="a" class="mr-2"> a) (4, 2)</label>
                        <label class="flex items-center"><input type="radio" name="q5" value="b" class="mr-2"> b) (5, 3)</label>
                        <label class="flex items-center"><input type="radio" name="q5" value="c" class="mr-2"> c) (6, 4)</label>
                        <label class="flex items-center"><input type="radio" name="q5" value="d" class="mr-2"> d) (3, 1)</label>
                    </div>
                    <button onclick="checkAnswer('q5', 'a', 'Benar! Substitusi x = y + 2 ke 2x + 3y = 16: 2(y + 2) + 3y = 16 → 2y + 4 + 3y = 16 → 5y = 12 → y = 2.4 ≈ 2, x = 4.')" class="mt-3 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600">Cek Jawaban</button>
                    <div id="feedback-q5" class="mt-2"></div>
                </div>

                <div class="quiz-question bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-lg" data-level="sedang">
                    <h4 class="font-semibold text-yellow-700 mb-2">🟡 Soal 6 (Sedang) - Eliminasi Bertahap</h4>
                    <p class="mb-3">Dari sistem $\begin{cases} 3x + 2y = 12 \\ 2x - 3y = 1 \end{cases}$, nilai x + y adalah...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q6" value="a" class="mr-2"> a) 3</label>
                        <label class="flex items-center"><input type="radio" name="q6" value="b" class="mr-2"> b) 4</label>
                        <label class="flex items-center"><input type="radio" name="q6" value="c" class="mr-2"> c) 5</label>
                        <label class="flex items-center"><input type="radio" name="q6" value="d" class="mr-2"> d) 6</label>
                    </div>
                    <button onclick="checkAnswer('q6', 'c', 'Benar! Eliminasi y: kalikan persamaan pertama dengan 3 dan kedua dengan 2: 9x + 6y = 36 dan 4x - 6y = 2. Jumlahkan: 13x = 38 → x ≈ 2.9. Substitusi untuk y ≈ 2.1. x + y ≈ 5.')" class="mt-3 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600">Cek Jawaban</button>
                    <div id="feedback-q6" class="mt-2"></div>
                </div>

                <div class="quiz-question bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-lg" data-level="sedang">
                    <h4 class="font-semibold text-yellow-700 mb-2">🟡 Soal 7 (Sedang) - Aplikasi Ekonomi</h4>
                    <p class="mb-3">Harga 2 kg apel + 3 kg jeruk = Rp 23.000. Harga 4 kg apel + 1 kg jeruk = Rp 21.000. Harga 1 kg apel adalah...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q7" value="a" class="mr-2"> a) Rp 3.000</label>
                        <label class="flex items-center"><input type="radio" name="q7" value="b" class="mr-2"> b) Rp 4.000</label>
                        <label class="flex items-center"><input type="radio" name="q7" value="c" class="mr-2"> c) Rp 5.000</label>
                        <label class="flex items-center"><input type="radio" name="q7" value="d" class="mr-2"> d) Rp 6.000</label>
                    </div>
                    <button onclick="checkAnswer('q7', 'b', 'Benar! Sistem: 2x + 3y = 23000 dan 4x + y = 21000. Eliminasi y: kalikan persamaan kedua dengan 3: 12x + 3y = 63000. Kurangkan: 10x = 40000 → x = 4000.')" class="mt-3 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600">Cek Jawaban</button>
                    <div id="feedback-q7" class="mt-2"></div>
                </div>

                <div class="quiz-question bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-lg" data-level="sedang">
                    <h4 class="font-semibold text-yellow-700 mb-2">🟡 Soal 8 (Sedang) - Campuran Metode</h4>
                    <p class="mb-3">Sistem $\begin{cases} 5x - 2y = 8 \\ 3x + y = 7 \end{cases}$ paling efisien diselesaikan dengan metode...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q8" value="a" class="mr-2"> a) Substitusi (isolasi y dari persamaan kedua)</label>
                        <label class="flex items-center"><input type="radio" name="q8" value="b" class="mr-2"> b) Eliminasi x terlebih dahulu</label>
                        <label class="flex items-center"><input type="radio" name="q8" value="c" class="mr-2"> c) Eliminasi y terlebih dahulu</label>
                        <label class="flex items-center"><input type="radio" name="q8" value="d" class="mr-2"> d) Metode grafik</label>
                    </div>
                    <button onclick="checkAnswer('q8', 'a', 'Benar! Persamaan kedua mudah diisolasi: y = 7 - 3x. Substitusi ke persamaan pertama lebih efisien daripada eliminasi yang memerlukan perkalian dengan konstanta besar.')" class="mt-3 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600">Cek Jawaban</button>
                    <div id="feedback-q8" class="mt-2"></div>
                </div>

                <!-- Soal Sulit -->
                <div class="quiz-question bg-red-50 border-l-4 border-red-500 p-4 rounded-lg" data-level="sulit">
                    <h4 class="font-semibold text-red-700 mb-2">🔴 Soal 9 (Sulit) - Sistem dengan Pecahan</h4>
                    <p class="mb-3">Solusi dari sistem $\begin{cases} \frac{x}{2} + \frac{y}{3} = 5 \\ \frac{x}{3} - \frac{y}{2} = 1 \end{cases}$ adalah...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q9" value="a" class="mr-2"> a) (6, 6)</label>
                        <label class="flex items-center"><input type="radio" name="q9" value="b" class="mr-2"> b) (8, 4)</label>
                        <label class="flex items-center"><input type="radio" name="q9" value="c" class="mr-2"> c) (9, 3)</label>
                        <label class="flex items-center"><input type="radio" name="q9" value="d" class="mr-2"> d) (12, 6)</label>
                    </div>
                    <button onclick="checkAnswer('q9', 'a', 'Benar! Kalikan persamaan pertama dengan 6: 3x + 2y = 30. Kalikan persamaan kedua dengan 6: 2x - 3y = 6. Eliminasi: x = 6, y = 6.')" class="mt-3 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Cek Jawaban</button>
                    <div id="feedback-q9" class="mt-2"></div>
                </div>

                <div class="quiz-question bg-red-50 border-l-4 border-red-500 p-4 rounded-lg" data-level="sulit">
                    <h4 class="font-semibold text-red-700 mb-2">🔴 Soal 10 (Sulit) - Aplikasi Kompleks</h4>
                    <p class="mb-3">Dalam sebuah kandang terdapat ayam dan kambing dengan total 35 ekor dan 94 kaki. Jumlah ayam adalah...</p>
                    <div class="space-y-2">
                        <label class="flex items-center"><input type="radio" name="q10" value="a" class="mr-2"> a) 23 ekor</label>
                        <label class="flex items-center"><input type="radio" name="q10" value="b" class="mr-2"> b) 24 ekor</label>
                        <label class="flex items-center"><input type="radio" name="q10" value="c" class="mr-2"> c) 25 ekor</label>
                        <label class="flex items-center"><input type="radio" name="q10" value="d" class="mr-2"> d) 26 ekor</label>
                    </div>
                    <button onclick="checkAnswer('q10', 'a', 'Benar! Sistem: x + y = 35 (total hewan) dan 2x + 4y = 94 (total kaki). Eliminasi: 2x + 2y = 70, kurangkan dari persamaan kedua: 2y = 24 → y = 12 kambing. Jadi x = 23 ayam.')" class="mt-3 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Cek Jawaban</button>
                    <div id="feedback-q10" class="mt-2"></div>
                </div>
            </div>

            <!-- Progress Tracker -->
            <div class="mt-6 bg-white rounded-lg p-4">
                <h4 class="font-semibold mb-2">📊 Progress Latihan</h4>
                <div id="progress-tracker" class="grid grid-cols-3 gap-4 text-center">
                    <div class="bg-green-100 p-2 rounded">
                        <p class="text-sm font-semibold text-green-700">Mudah</p>
                        <p id="easy-score" class="text-lg font-bold text-green-600">0/4</p>
                    </div>
                    <div class="bg-yellow-100 p-2 rounded">
                        <p class="text-sm font-semibold text-yellow-700">Sedang</p>
                        <p id="medium-score" class="text-lg font-bold text-yellow-600">0/4</p>
                    </div>
                    <div class="bg-red-100 p-2 rounded">
                        <p class="text-sm font-semibold text-red-700">Sulit</p>
                        <p id="hard-score" class="text-lg font-bold text-red-600">0/2</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 6: Diskusi & Refleksi -->
        <section class="section-card bg-gradient-to-r from-indigo-100 to-purple-100 rounded-xl p-6 shadow-lg">
            <h3 class="text-2xl font-bold text-indigo-800 mb-4">💭 Diskusi & Refleksi</h3>
            
            <!-- Method Comparison -->
            <div class="bg-white rounded-lg p-4 mb-6">
                <h4 class="font-semibold text-indigo-700 mb-3">⚖️ Perbandingan Metode</h4>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="border-l-4 border-blue-300 pl-4">
                        <h5 class="font-semibold text-blue-600 mb-2">Metode Substitusi</h5>
                        <div class="text-sm text-gray-600 space-y-1">
                            <p><strong>Kelebihan:</strong></p>
                            <p>• Mudah dipahami konsepnya</p>
                            <p>• Efektif untuk sistem dengan koefisien sederhana</p>
                            <p>• Langkah-langkah jelas dan sistematis</p>
                            <p><strong>Kekurangan:</strong></p>
                            <p>• Dapat menghasilkan pecahan kompleks</p>
                            <p>• Kurang efisien untuk koefisien besar</p>
                        </div>
                    </div>
                    <div class="border-l-4 border-red-300 pl-4">
                        <h5 class="font-semibold text-red-600 mb-2">Metode Eliminasi</h5>
                        <div class="text-sm text-gray-600 space-y-1">
                            <p><strong>Kelebihan:</strong></p>
                            <p>• Efisien untuk berbagai jenis sistem</p>
                            <p>• Menghindari pecahan kompleks</p>
                            <p>• Fleksibel dalam pemilihan variabel</p>
                            <p><strong>Kekurangan:</strong></p>
                            <p>• Memerlukan pemahaman operasi aljabar</p>
                            <p>• Perlu ketelitian dalam perkalian</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Discussion Questions -->
            <div class="bg-white rounded-lg p-4 mb-6">
                <h4 class="font-semibold text-indigo-700 mb-3">🤔 Pertanyaan Diskusi</h4>
                <div class="space-y-4">
                    <div class="border-l-4 border-indigo-300 pl-4">
                        <p class="font-medium">1. Kapan sebaiknya menggunakan metode substitusi?</p>
                        <textarea class="w-full mt-2 p-2 border rounded-lg" rows="3" placeholder="Tuliskan analisis Anda..."></textarea>
                    </div>
                    <div class="border-l-4 border-indigo-300 pl-4">
                        <p class="font-medium">2. Dalam situasi apa metode eliminasi lebih efektif?</p>
                        <textarea class="w-full mt-2 p-2 border rounded-lg" rows="3" placeholder="Berikan contoh dan alasan..."></textarea>
                    </div>
                    <div class="border-l-4 border-indigo-300 pl-4">
                        <p class="font-medium">3. Bagaimana cara memilih metode yang tepat untuk sistem tertentu?</p>
                        <textarea class="w-full mt-2 p-2 border rounded-lg" rows="3" placeholder="Jelaskan strategi Anda..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Self-Assessment -->
            <div class="bg-white rounded-lg p-4">
                <h4 class="font-semibold text-indigo-700 mb-3">⭐ Penilaian Pemahaman Diri (1-5)</h4>
                <div class="space-y-3">
                    <div>
                        <p class="mb-2">Seberapa baik Anda memahami metode substitusi?</p>
                        <div class="flex space-x-2" id="substitusi-rating">
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('substitusi', 1)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('substitusi', 2)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('substitusi', 3)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('substitusi', 4)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('substitusi', 5)">⭐</span>
                        </div>
                    </div>
                    <div>
                        <p class="mb-2">Seberapa baik Anda memahami metode eliminasi?</p>
                        <div class="flex space-x-2" id="eliminasi-rating">
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('eliminasi', 1)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('eliminasi', 2)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('eliminasi', 3)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('eliminasi', 4)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('eliminasi', 5)">⭐</span>
                        </div>
                    </div>
                    <div>
                        <p class="mb-2">Seberapa baik Anda dapat memilih metode yang tepat?</p>
                        <div class="flex space-x-2" id="selection-rating">
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('selection', 1)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('selection', 2)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('selection', 3)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('selection', 4)">⭐</span>
                            <span class="rating-star text-2xl text-gray-300 hover:text-yellow-400 cursor-pointer" onclick="setRating('selection', 5)">⭐</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Summary -->
        <section class="section-card bg-gradient-to-r from-emerald-100 to-teal-100 rounded-xl p-6 shadow-lg">
            <h3 class="text-2xl font-bold text-emerald-800 mb-4">🎯 Ringkasan Pembelajaran</h3>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg p-4">
                    <h4 class="font-semibold text-emerald-700 mb-2">✅ Yang Telah Dipelajari</h4>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>• Konsep sistem persamaan linear dua variabel</li>
                        <li>• Metode substitusi dan langkah-langkahnya</li>
                        <li>• Metode eliminasi dan teknik penerapannya</li>
                        <li>• Pemilihan metode yang efektif</li>
                        <li>• Aplikasi dalam masalah kehidupan nyata</li>
                        <li>• Verifikasi solusi sistem persamaan</li>
                    </ul>
                </div>
                <div class="bg-white rounded-lg p-4">
                    <h4 class="font-semibold text-emerald-700 mb-2">🚀 Langkah Selanjutnya</h4>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>• Metode campuran (substitusi-eliminasi)</li>
                        <li>• Sistem persamaan dengan tiga variabel</li>
                        <li>• Sistem persamaan non-linear</li>
                        <li>• Aplikasi dalam program linear</li>
                        <li>• Penggunaan matriks untuk sistem persamaan</li>
                        <li>• Sistem persamaan dalam geometri analitik</li>
                    </ul>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white p-6 mt-12">
        <div class="max-w-6xl mx-auto text-center">
            <p class="mb-2">📚 LKPD Interaktif Matematika - Kelas 9</p>
            <p class="text-sm text-gray-400">Sistem Persamaan Linear Dua Variabel</p>
            <p class="text-xs text-gray-500 mt-2">Fokus: Metode Substitusi dan Eliminasi</p>
        </div>
    </footer>

    <script>
        // Score tracking
        let scores = {
            mudah: 0,
            sedang: 0,
            sulit: 0
        };

        let maxScores = {
            mudah: 4,
            sedang: 4,
            sulit: 2
        };

        // Story problems variables
        let currentStoryProblem = null;
        let storyProblemIndex = 0;
        let solvedStoryProblems = new Set();
        let currentStoryMethod = 'substitusi';
        
        // Math problems variables
        let currentMathProblem = null;
        let mathProblemsSolved = 0;
        let currentMathMethod = 'substitusi';
        let currentDifficulty = 'easy';

        // Story problems for practice (20 variations)
        const storyProblems = [
            {
                story: "Di sebuah toko, Ani membeli 3 buku dan 2 pensil dengan harga total Rp 15.000. Budi membeli 2 buku dan 4 pensil dengan harga total Rp 18.000. Tentukan harga 1 buku dan 1 pensil!",
                variables: { x: "harga 1 buku (Rp)", y: "harga 1 pensil (Rp)" },
                equations: { eq1: "3x + 2y = 15000", eq2: "2x + 4y = 18000" },
                solution: { x: 3000, y: 3000 }
            },
            {
                story: "Dalam sebuah kandang terdapat ayam dan kambing dengan total 20 ekor dan 56 kaki. Berapa jumlah ayam dan kambing?",
                variables: { x: "jumlah ayam (ekor)", y: "jumlah kambing (ekor)" },
                equations: { eq1: "x + y = 20", eq2: "2x + 4y = 56" },
                solution: { x: 12, y: 8 }
            },
            {
                story: "Pak Budi membeli 5 kg apel dan 3 kg jeruk seharga Rp 47.000. Pak Ahmad membeli 2 kg apel dan 4 kg jeruk seharga Rp 38.000. Berapa harga per kg apel dan jeruk?",
                variables: { x: "harga 1 kg apel (Rp)", y: "harga 1 kg jeruk (Rp)" },
                equations: { eq1: "5x + 3y = 47000", eq2: "2x + 4y = 38000" },
                solution: { x: 7000, y: 6000 }
            },
            {
                story: "Umur ayah dan anak sekarang berjumlah 50 tahun. 10 tahun yang akan datang, umur ayah akan 3 kali umur anak. Berapa umur ayah dan anak sekarang?",
                variables: { x: "umur ayah sekarang (tahun)", y: "umur anak sekarang (tahun)" },
                equations: { eq1: "x + y = 50", eq2: "x + 10 = 3(y + 10)" },
                solution: { x: 40, y: 10 }
            },
            {
                story: "Sebuah bilangan terdiri dari 2 digit. Jumlah kedua digitnya adalah 12. Jika digit-digitnya dibalik, bilangan baru akan 18 lebih kecil dari bilangan asli. Tentukan bilangan tersebut!",
                variables: { x: "digit puluhan", y: "digit satuan" },
                equations: { eq1: "x + y = 12", eq2: "10x + y - (10y + x) = 18" },
                solution: { x: 7, y: 5 }
            },
            {
                story: "Di sebuah parkir terdapat 25 kendaraan yang terdiri dari mobil dan motor. Jumlah roda seluruhnya 70 buah. Berapa jumlah mobil dan motor?",
                variables: { x: "jumlah mobil", y: "jumlah motor" },
                equations: { eq1: "x + y = 25", eq2: "4x + 2y = 70" },
                solution: { x: 10, y: 15 }
            },
            {
                story: "Harga 4 buku tulis dan 3 pulpen adalah Rp 26.000. Harga 2 buku tulis dan 5 pulpen adalah Rp 24.000. Berapa harga 1 buku tulis dan 1 pulpen?",
                variables: { x: "harga 1 buku tulis (Rp)", y: "harga 1 pulpen (Rp)" },
                equations: { eq1: "4x + 3y = 26000", eq2: "2x + 5y = 24000" },
                solution: { x: 4000, y: 3200 }
            },
            {
                story: "Keliling persegi panjang adalah 28 cm. Panjangnya 4 cm lebih dari lebarnya. Berapa panjang dan lebar persegi panjang tersebut?",
                variables: { x: "panjang (cm)", y: "lebar (cm)" },
                equations: { eq1: "2x + 2y = 28", eq2: "x = y + 4" },
                solution: { x: 9, y: 5 }
            },
            {
                story: "Dalam sebuah tes, nilai rata-rata 30 siswa adalah 75. Jika 10 siswa mendapat nilai 80 dan sisanya mendapat nilai yang sama, berapa nilai yang diperoleh siswa lainnya?",
                variables: { x: "jumlah nilai 10 siswa pertama", y: "nilai setiap siswa lainnya" },
                equations: { eq1: "x + 20y = 2250", eq2: "x = 800" },
                solution: { x: 800, y: 72.5 }
            },
            {
                story: "Seorang pedagang membeli 40 kg beras dengan 2 jenis. Jenis A seharga Rp 8.000/kg dan jenis B seharga Rp 12.000/kg. Total yang dibayar Rp 400.000. Berapa kg masing-masing jenis beras?",
                variables: { x: "beras jenis A (kg)", y: "beras jenis B (kg)" },
                equations: { eq1: "x + y = 40", eq2: "8000x + 12000y = 400000" },
                solution: { x: 20, y: 20 }
            },
            {
                story: "Jumlah dua bilangan adalah 35. Selisih kedua bilangan tersebut adalah 7. Tentukan kedua bilangan tersebut!",
                variables: { x: "bilangan pertama", y: "bilangan kedua" },
                equations: { eq1: "x + y = 35", eq2: "x - y = 7" },
                solution: { x: 21, y: 14 }
            },
            {
                story: "Harga 3 kg mangga dan 2 kg apel adalah Rp 35.000. Harga 1 kg mangga dan 4 kg apel adalah Rp 33.000. Berapa harga per kg mangga dan apel?",
                variables: { x: "harga 1 kg mangga (Rp)", y: "harga 1 kg apel (Rp)" },
                equations: { eq1: "3x + 2y = 35000", eq2: "x + 4y = 33000" },
                solution: { x: 7000, y: 7000 }
            },
            {
                story: "Sebuah toko menjual tiket dewasa dan anak-anak. Hari ini terjual 50 tiket dengan total penjualan Rp 400.000. Harga tiket dewasa Rp 10.000 dan anak-anak Rp 6.000. Berapa tiket masing-masing yang terjual?",
                variables: { x: "tiket dewasa", y: "tiket anak-anak" },
                equations: { eq1: "x + y = 50", eq2: "10000x + 6000y = 400000" },
                solution: { x: 25, y: 25 }
            },
            {
                story: "Dalam sebuah kelas terdapat 32 siswa. Jumlah siswa laki-laki 4 orang lebih banyak dari siswa perempuan. Berapa jumlah siswa laki-laki dan perempuan?",
                variables: { x: "siswa laki-laki", y: "siswa perempuan" },
                equations: { eq1: "x + y = 32", eq2: "x = y + 4" },
                solution: { x: 18, y: 14 }
            },
            {
                story: "Pak Andi memiliki uang pecahan Rp 5.000 dan Rp 10.000 sebanyak 15 lembar dengan total nilai Rp 100.000. Berapa lembar masing-masing pecahan?",
                variables: { x: "lembar Rp 5.000", y: "lembar Rp 10.000" },
                equations: { eq1: "x + y = 15", eq2: "5000x + 10000y = 100000" },
                solution: { x: 10, y: 5 }
            },
            {
                story: "Harga 2 pensil dan 3 penghapus adalah Rp 11.000. Harga 4 pensil dan 1 penghapus adalah Rp 13.000. Berapa harga 1 pensil dan 1 penghapus?",
                variables: { x: "harga 1 pensil (Rp)", y: "harga 1 penghapus (Rp)" },
                equations: { eq1: "2x + 3y = 11000", eq2: "4x + y = 13000" },
                solution: { x: 3000, y: 1000 }
            },
            {
                story: "Sebuah segitiga memiliki keliling 24 cm. Sisi pertama 2 cm lebih panjang dari sisi kedua, dan sisi ketiga sama dengan sisi kedua. Berapa panjang masing-masing sisi?",
                variables: { x: "sisi pertama (cm)", y: "sisi kedua (cm)" },
                equations: { eq1: "x + y + y = 24", eq2: "x = y + 2" },
                solution: { x: 9, y: 7 }
            },
            {
                story: "Dalam sebuah lomba, peserta mendapat poin 5 untuk jawaban benar dan -2 untuk jawaban salah. Seorang peserta menjawab 20 soal dan mendapat total poin 64. Berapa soal yang dijawab benar dan salah?",
                variables: { x: "jawaban benar", y: "jawaban salah" },
                equations: { eq1: "x + y = 20", eq2: "5x - 2y = 64" },
                solution: { x: 16, y: 4 }
            },
            {
                story: "Harga 6 donat dan 4 roti adalah Rp 34.000. Harga 3 donat dan 8 roti adalah Rp 37.000. Berapa harga 1 donat dan 1 roti?",
                variables: { x: "harga 1 donat (Rp)", y: "harga 1 roti (Rp)" },
                equations: { eq1: "6x + 4y = 34000", eq2: "3x + 8y = 37000" },
                solution: { x: 3000, y: 4000 }
            },
            {
                story: "Sebuah persegi panjang memiliki luas 48 cm². Panjangnya 2 kali lebarnya. Berapa panjang dan lebar persegi panjang tersebut?",
                variables: { x: "panjang (cm)", y: "lebar (cm)" },
                equations: { eq1: "x × y = 48", eq2: "x = 2y" },
                solution: { x: 8, y: 6 }
            }
        ];

        // Math problems generator
        const mathProblems = {
            easy: [
                { eq1: "x + y = 8", eq2: "x - y = 2", solution: { x: 5, y: 3 } },
                { eq1: "2x + y = 9", eq2: "x - y = 3", solution: { x: 4, y: 1 } },
                { eq1: "x + 2y = 10", eq2: "x - y = 1", solution: { x: 4, y: 3 } },
                { eq1: "3x + y = 11", eq2: "x + y = 5", solution: { x: 3, y: 2 } },
                { eq1: "2x + 3y = 13", eq2: "x - y = 1", solution: { x: 4, y: 3 } }
            ],
            medium: [
                { eq1: "2x + 3y = 16", eq2: "3x - 2y = 2", solution: { x: 4, y: 2 } },
                { eq1: "4x + 2y = 18", eq2: "2x - 3y = -4", solution: { x: 3, y: 3 } },
                { eq1: "3x + 4y = 25", eq2: "2x - y = 3", solution: { x: 3, y: 4 } },
                { eq1: "5x + 2y = 24", eq2: "3x - 4y = 2", solution: { x: 4, y: 2 } },
                { eq1: "2x + 5y = 21", eq2: "4x - 3y = 5", solution: { x: 3, y: 3 } }
            ],
            hard: [
                { eq1: "3x + 4y = 26", eq2: "5x - 2y = 8", solution: { x: 2, y: 5 } },
                { eq1: "4x + 3y = 33", eq2: "2x - 5y = -11", solution: { x: 6, y: 3 } },
                { eq1: "6x + 2y = 28", eq2: "3x - 4y = -2", solution: { x: 4, y: 2 } },
                { eq1: "5x + 3y = 31", eq2: "2x - 4y = -6", solution: { x: 5, y: 2 } },
                { eq1: "7x + 2y = 30", eq2: "3x - 5y = -9", solution: { x: 3, y: 4 } }
            ]
        };

        // Method selection functions
        function selectMethod(method) {
            // Remove active class from all method cards
            document.querySelectorAll('.method-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active class to selected method
            event.target.closest('.method-card').classList.add('active');
            
            // Show corresponding demo
            document.getElementById('substitusi-demo').classList.add('hidden');
            document.getElementById('eliminasi-demo').classList.add('hidden');
            document.getElementById(`${method}-demo`).classList.remove('hidden');
            
            // Re-render MathJax
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        }

        // Interactive solver functions
        function setActiveMethod(method) {
            currentMethod = method;
            currentStep = 0;
            
            // Update button styles
            document.getElementById('method-substitusi').className = method === 'substitusi' ? 
                'bg-blue-500 text-white px-4 py-2 rounded text-sm hover:bg-blue-600' : 
                'bg-gray-300 text-gray-700 px-4 py-2 rounded text-sm hover:bg-gray-400';
            document.getElementById('method-eliminasi').className = method === 'eliminasi' ? 
                'bg-blue-500 text-white px-4 py-2 rounded text-sm hover:bg-blue-600' : 
                'bg-gray-300 text-gray-700 px-4 py-2 rounded text-sm hover:bg-gray-400';
            
            // Update description
            const descriptions = {
                substitusi: '<p><strong>Metode Substitusi:</strong> Isolasi satu variabel, lalu substitusi ke persamaan lain</p>',
                eliminasi: '<p><strong>Metode Eliminasi:</strong> Hilangkan satu variabel dengan operasi aljabar</p>'
            };
            document.getElementById('method-description').innerHTML = descriptions[method];
            
            // Initialize work area
            initializeWorkArea();
        }

        function initializeWorkArea() {
            if (!currentSystemProblem) {
                currentSystemProblem = systemProblems[0];
            }
            
            const workArea = document.getElementById('work-area');
            workArea.innerHTML = `
                <div class="text-center mb-4">
                    <h6 class="font-semibold mb-2">Sistem Persamaan:</h6>
                    <div class="bg-blue-50 p-3 rounded-lg">
                        <p>$\\begin{cases} ${currentSystemProblem.eq1} \\\\ ${currentSystemProblem.eq2} \\end{cases}$</p>
                    </div>
                </div>
                <div id="step-work-area" class="space-y-3">
                    <p class="text-sm text-gray-600">Klik "Langkah Selanjutnya" untuk memulai penyelesaian dengan metode ${currentMethod}</p>
                </div>
            `;
            
            // Re-render MathJax
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        }

        function nextStep() {
            if (!currentSystemProblem) return;
            
            const steps = currentSystemProblem.steps[currentMethod];
            if (currentStep >= steps.length) {
                alert('Penyelesaian sudah selesai! Periksa jawaban Anda.');
                return;
            }
            
            const stepWorkArea = document.getElementById('step-work-area');
            const stepDiv = document.createElement('div');
            stepDiv.className = 'solution-step bg-yellow-50 border-l-4 border-yellow-400';
            stepDiv.innerHTML = `
                <div class="flex items-center mb-2">
                    <span class="step-number">${currentStep + 1}</span>
                    <span class="ml-2 font-semibold">Langkah ${currentStep + 1}</span>
                </div>
                <p class="ml-8">${steps[currentStep]}</p>
            `;
            
            stepWorkArea.appendChild(stepDiv);
            currentStep++;
            
            // Re-render MathJax
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        }

        function showHint() {
            if (!currentSystemProblem) return;
            
            const hints = {
                substitusi: [
                    "Pilih persamaan yang mudah diisolasi (koefisien 1 atau -1)",
                    "Substitusi dengan hati-hati, perhatikan tanda operasi",
                    "Sederhanakan persamaan satu variabel dengan teliti",
                    "Jangan lupa mencari nilai variabel yang kedua"
                ],
                eliminasi: [
                    "Pilih variabel yang akan dieliminasi terlebih dahulu",
                    "Samakan koefisien dengan mengalikan konstanta yang tepat",
                    "Perhatikan tanda: jumlahkan jika berlawanan, kurangkan jika sama",
                    "Substitusi kembali untuk mencari variabel lainnya"
                ]
            };
            
            const hint = hints[currentMethod][Math.min(currentStep, hints[currentMethod].length - 1)];
            alert(`💡 Petunjuk: ${hint}`);
        }

        function resetSolver() {
            currentStep = 0;
            initializeWorkArea();
            document.getElementById('answer-x').value = '';
            document.getElementById('answer-y').value = '';
            document.getElementById('system-solution-feedback').innerHTML = '';
        }

        function generateNewSystemProblem() {
            systemProblemIndex = (systemProblemIndex + 1) % systemProblems.length;
            currentSystemProblem = systemProblems[systemProblemIndex];
            
            // Update problem display
            document.getElementById('current-system-problem').innerHTML = `
                <p class="font-medium">$$\\begin{cases} ${currentSystemProblem.eq1} \\\\ ${currentSystemProblem.eq2} \\end{cases}$$</p>
                <p class="text-sm text-gray-600 mt-1">Soal ${systemProblemIndex + 1} dari ${systemProblems.length}</p>
            `;
            
            // Reset solver
            resetSolver();
            
            // Re-render MathJax
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        }

        function checkSystemSolution() {
            if (!currentSystemProblem) return;
            
            const inputX = parseFloat(document.getElementById('answer-x').value);
            const inputY = parseFloat(document.getElementById('answer-y').value);
            const feedback = document.getElementById('system-solution-feedback');
            
            if (isNaN(inputX) || isNaN(inputY)) {
                feedback.innerHTML = '<p class="text-red-600 text-sm">⚠️ Silakan masukkan nilai x dan y yang valid!</p>';
                return;
            }
            
            const expectedX = currentSystemProblem.solution.x;
            const expectedY = currentSystemProblem.solution.y;
            const tolerance = 0.1;
            
            if (Math.abs(inputX - expectedX) < tolerance && Math.abs(inputY - expectedY) < tolerance) {
                feedback.innerHTML = `<div class="correct p-2 rounded text-sm"><p class="font-medium">✅ Benar!</p><p>Solusi sistem adalah x = ${expectedX}, y = ${expectedY}. Metode ${currentMethod} berhasil diterapkan!</p></div>`;
                
                // Track solved problem
                solvedSystemProblems.add(systemProblemIndex);
                updateSystemProgress();
            } else {
                feedback.innerHTML = `<div class="incorrect p-2 rounded text-sm"><p class="font-medium">❌ Kurang tepat.</p><p>Periksa kembali langkah-langkah penyelesaian. Solusi yang benar adalah x = ${expectedX}, y = ${expectedY}.</p></div>`;
            }
        }

        function updateSystemProgress() {
            const solved = solvedSystemProblems.size;
            const total = systemProblems.length;
            const percentage = (solved / total) * 100;
            
            document.getElementById('system-problems-solved').textContent = `${solved}/${total}`;
            document.getElementById('system-progress-bar').style.width = `${percentage}%`;
            
            if (solved === total) {
                setTimeout(() => {
                    alert('🎉 Selamat! Anda telah menyelesaikan semua soal latihan sistem persamaan!');
                }, 500);
            }
        }

        // Quiz functions
        function checkAnswer(questionId, correctAnswer, explanation) {
            const selectedAnswer = document.querySelector(`input[name="${questionId}"]:checked`);
            const feedbackDiv = document.getElementById(`feedback-${questionId}`);
            
            if (!selectedAnswer) {
                feedbackDiv.innerHTML = '<p class="text-red-600 font-medium">⚠️ Silakan pilih jawaban terlebih dahulu!</p>';
                return;
            }

            const questionElement = document.querySelector(`input[name="${questionId}"]`).closest('.quiz-question');
            const level = questionElement.getAttribute('data-level');
            
            if (selectedAnswer.value === correctAnswer) {
                feedbackDiv.innerHTML = `<div class="correct p-3 rounded-lg border"><p class="font-medium">✅ Benar!</p><p class="text-sm mt-1">${explanation}</p></div>`;
                
                // Update score if not already answered correctly
                if (!questionElement.classList.contains('answered-correctly')) {
                    scores[level]++;
                    questionElement.classList.add('answered-correctly');
                    updateProgressTracker();
                }
            } else {
                feedbackDiv.innerHTML = `<div class="incorrect p-3 rounded-lg border"><p class="font-medium">❌ Kurang tepat.</p><p class="text-sm mt-1">${explanation}</p></div>`;
            }

            // Disable all radio buttons for this question
            document.querySelectorAll(`input[name="${questionId}"]`).forEach(input => {
                input.disabled = true;
            });
        }

        // Update progress tracker
        function updateProgressTracker() {
            document.getElementById('easy-score').textContent = `${scores.mudah}/${maxScores.mudah}`;
            document.getElementById('medium-score').textContent = `${scores.sedang}/${maxScores.sedang}`;
            document.getElementById('hard-score').textContent = `${scores.sulit}/${maxScores.sulit}`;
        }

        // Rating system
        function setRating(type, rating) {
            const ratingContainer = document.getElementById(`${type}-rating`);
            const stars = ratingContainer.querySelectorAll('.rating-star');
            
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.remove('text-gray-300');
                    star.classList.add('text-yellow-400');
                } else {
                    star.classList.remove('text-yellow-400');
                    star.classList.add('text-gray-300');
                }
            });
        }

        // Reset all function
        function resetAll() {
            if (confirm('Apakah Anda yakin ingin mereset semua jawaban dan progress?')) {
                // Reset scores
                scores = {
                    mudah: 0,
                    sedang: 0,
                    sulit: 0
                };
                
                // Reset all radio buttons
                document.querySelectorAll('input[type="radio"]').forEach(input => {
                    input.checked = false;
                    input.disabled = false;
                });
                
                // Clear all feedback
                document.querySelectorAll('[id^="feedback-"]').forEach(div => {
                    div.innerHTML = '';
                });
                
                // Remove answered-correctly class
                document.querySelectorAll('.quiz-question').forEach(question => {
                    question.classList.remove('answered-correctly');
                });
                
                // Reset ratings
                document.querySelectorAll('.rating-star').forEach(star => {
                    star.classList.remove('text-yellow-400');
                    star.classList.add('text-gray-300');
                });
                
                // Clear textareas and inputs
                document.querySelectorAll('textarea, input[type="text"]').forEach(element => {
                    element.value = '';
                });
                
                // Reset story problems
                storyProblemIndex = 0;
                currentStoryProblem = storyProblems[0];
                solvedStoryProblems.clear();
                document.getElementById('current-story-problem').innerHTML = `
                    <div id="story-text" class="text-gray-700 mb-3">
                        <p>${currentStoryProblem.story}</p>
                    </div>
                    <p class="text-sm text-gray-600">Cerita 1 dari ${storyProblems.length}</p>
                `;
                
                // Reset math problems
                mathProblemsSolved = 0;
                currentDifficulty = 'easy';
                document.getElementById('difficulty-level').value = 'easy';
                generateMathProblem();
                
                // Update progress trackers
                updateProgressTracker();
                updateStoryProgress();
                
                // Reset method demos
                document.querySelectorAll('.method-card').forEach(card => {
                    card.classList.remove('active');
                });
                document.getElementById('substitusi-demo').classList.add('hidden');
                document.getElementById('eliminasi-demo').classList.add('hidden');
                
                alert('✅ Semua data telah direset! Anda dapat memulai kembali.');
            }
        }

        // Story problem functions
        function generateNewStoryProblem() {
            storyProblemIndex = (storyProblemIndex + 1) % storyProblems.length;
            currentStoryProblem = storyProblems[storyProblemIndex];
            
            // Update the entire story container with new content
            document.getElementById('current-story-problem').innerHTML = `
                <div id="story-text" class="text-gray-700 mb-3">
                    <p>${currentStoryProblem.story}</p>
                </div>
                <p class="text-sm text-gray-600">Cerita ${storyProblemIndex + 1} dari ${storyProblems.length}</p>
            `;
            
            // Clear inputs
            document.getElementById('var-x-def').value = '';
            document.getElementById('var-y-def').value = '';
            document.getElementById('equation-1').value = '';
            document.getElementById('equation-2').value = '';
            document.getElementById('story-answer-x').value = '';
            document.getElementById('story-answer-y').value = '';
            document.getElementById('story-equation-feedback').innerHTML = '';
            document.getElementById('story-answer-feedback').innerHTML = '';
        }

        function setStoryMethod(method) {
            currentStoryMethod = method;
            document.getElementById('story-method-substitusi').className = method === 'substitusi' ? 
                'bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600' : 
                'bg-gray-300 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-400';
            document.getElementById('story-method-eliminasi').className = method === 'eliminasi' ? 
                'bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600' : 
                'bg-gray-300 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-400';
        }

        function checkStoryEquations() {
            if (!currentStoryProblem) return;
            
            const eq1 = document.getElementById('equation-1').value.trim().toLowerCase().replace(/\s/g, '');
            const eq2 = document.getElementById('equation-2').value.trim().toLowerCase().replace(/\s/g, '');
            const expectedEq1 = currentStoryProblem.equations.eq1.toLowerCase().replace(/\s/g, '');
            const expectedEq2 = currentStoryProblem.equations.eq2.toLowerCase().replace(/\s/g, '');
            
            const feedback = document.getElementById('story-equation-feedback');
            
            if ((eq1 === expectedEq1 && eq2 === expectedEq2) || (eq1 === expectedEq2 && eq2 === expectedEq1)) {
                feedback.innerHTML = `<div class="correct p-2 rounded text-sm"><p class="font-medium">✅ Sistem persamaan benar!</p><p>Sekarang selesaikan sistem tersebut dengan metode yang dipilih.</p></div>`;
            } else {
                feedback.innerHTML = `<div class="incorrect p-2 rounded text-sm"><p class="font-medium">❌ Sistem persamaan kurang tepat.</p><p>Petunjuk: x = ${currentStoryProblem.variables.x}, y = ${currentStoryProblem.variables.y}</p><p>Persamaan yang benar: ${currentStoryProblem.equations.eq1} dan ${currentStoryProblem.equations.eq2}</p></div>`;
            }
        }

        function checkStoryAnswer() {
            if (!currentStoryProblem) return;
            
            const inputX = parseFloat(document.getElementById('story-answer-x').value);
            const inputY = parseFloat(document.getElementById('story-answer-y').value);
            const feedback = document.getElementById('story-answer-feedback');
            
            if (isNaN(inputX) || isNaN(inputY)) {
                feedback.innerHTML = '<p class="text-red-600 text-sm">⚠️ Silakan masukkan nilai x dan y yang valid!</p>';
                return;
            }
            
            const expectedX = currentStoryProblem.solution.x;
            const expectedY = currentStoryProblem.solution.y;
            
            if (Math.abs(inputX - expectedX) < 0.1 && Math.abs(inputY - expectedY) < 0.1) {
                feedback.innerHTML = `<div class="correct p-2 rounded text-sm"><p class="font-medium">✅ Jawaban benar!</p><p>x = ${expectedX}, y = ${expectedY}</p></div>`;
                
                solvedStoryProblems.add(storyProblemIndex);
                updateStoryProgress();
            } else {
                feedback.innerHTML = `<div class="incorrect p-2 rounded text-sm"><p class="font-medium">❌ Jawaban kurang tepat.</p><p>Jawaban yang benar: x = ${expectedX}, y = ${expectedY}</p></div>`;
            }
        }

        function updateStoryProgress() {
            const solved = solvedStoryProblems.size;
            const total = storyProblems.length;
            const percentage = (solved / total) * 100;
            
            document.getElementById('story-problems-solved').textContent = `${solved}/${total}`;
            document.getElementById('story-progress-bar').style.width = `${percentage}%`;
        }

        // Math problem functions
        function generateMathProblem() {
            const problems = mathProblems[currentDifficulty];
            const randomIndex = Math.floor(Math.random() * problems.length);
            currentMathProblem = problems[randomIndex];
            
            document.getElementById('math-problem-display').innerHTML = `
                <p class="font-medium">$$\\begin{cases} ${currentMathProblem.eq1} \\\\ ${currentMathProblem.eq2} \\end{cases}$$</p>
                <p class="text-sm text-gray-600 mt-2">Selesaikan sistem persamaan di atas!</p>
            `;
            
            // Clear inputs
            document.getElementById('solution-steps').value = '';
            document.getElementById('math-answer-x').value = '';
            document.getElementById('math-answer-y').value = '';
            document.getElementById('math-solution-feedback').innerHTML = '';
            
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        }

        function setMathMethod(method) {
            currentMathMethod = method;
            document.getElementById('math-method-substitusi').className = method === 'substitusi' ? 
                'bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600' : 
                'bg-gray-300 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-400';
            document.getElementById('math-method-eliminasi').className = method === 'eliminasi' ? 
                'bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600' : 
                'bg-gray-300 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-400';
        }

        function checkMathSolution() {
            if (!currentMathProblem) return;
            
            const inputX = parseFloat(document.getElementById('math-answer-x').value);
            const inputY = parseFloat(document.getElementById('math-answer-y').value);
            const feedback = document.getElementById('math-solution-feedback');
            
            if (isNaN(inputX) || isNaN(inputY)) {
                feedback.innerHTML = '<p class="text-red-600 text-sm">⚠️ Silakan masukkan nilai x dan y yang valid!</p>';
                return;
            }
            
            const expectedX = currentMathProblem.solution.x;
            const expectedY = currentMathProblem.solution.y;
            
            if (Math.abs(inputX - expectedX) < 0.1 && Math.abs(inputY - expectedY) < 0.1) {
                feedback.innerHTML = `<div class="correct p-2 rounded text-sm"><p class="font-medium">✅ Jawaban benar!</p><p>Solusi: x = ${expectedX}, y = ${expectedY}</p></div>`;
                
                mathProblemsSolved++;
                document.getElementById('math-problems-solved').textContent = `${mathProblemsSolved}/∞`;
            } else {
                feedback.innerHTML = `<div class="incorrect p-2 rounded text-sm"><p class="font-medium">❌ Jawaban kurang tepat.</p><p>Solusi yang benar: x = ${expectedX}, y = ${expectedY}</p></div>`;
            }
        }

        function updateDifficulty() {
            currentDifficulty = document.getElementById('difficulty-level').value;
            generateMathProblem();
        }

        // Virtual keyboard functions
        function insertSymbol(symbol) {
            const textarea = document.getElementById('solution-steps');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const text = textarea.value;
            
            textarea.value = text.substring(0, start) + symbol + text.substring(end);
            textarea.selectionStart = textarea.selectionEnd = start + symbol.length;
            textarea.focus();
        }

        function insertSuperscript(superscript) {
            insertSymbol(superscript);
        }

        function insertNewLine() {
            insertSymbol('\n');
        }

        function insertSpace() {
            insertSymbol(' ');
        }

        function deleteLastChar() {
            const textarea = document.getElementById('solution-steps');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            
            if (start === end && start > 0) {
                const text = textarea.value;
                textarea.value = text.substring(0, start - 1) + text.substring(end);
                textarea.selectionStart = textarea.selectionEnd = start - 1;
            } else if (start !== end) {
                const text = textarea.value;
                textarea.value = text.substring(0, start) + text.substring(end);
                textarea.selectionStart = textarea.selectionEnd = start;
            }
            textarea.focus();
        }

        // Initialize on page load
        window.addEventListener('load', function() {
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
            
            // Initialize first story problem
            currentStoryProblem = storyProblems[0];
            
            // Initialize first math problem
            generateMathProblem();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96b4785bd4db7324',t:'MTc1NDU0NTU1MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
